var myWords=[],lektionenArr=[],lekSelectArr=[],checkLekCountandLekNum=!1,wordsFromXlsx=[],WordsToWrite=[],fileName="",lekCount=-1,fileType="";function setArrays(e){for(let r=1;r<=e;r++){let o="Lek"+r;lektionenArr.push(o);let t=!1;lekSelectArr.push(t);let l=[];wordsFromXlsx.push(l)}}async function readMyXlsxFile(e){let r=await XLSX.read(await (await fetch(e)).arrayBuffer());if("localFile"==fileType){var o=Number(r.Sheets.Sheet1.A1.w)+1;setWordsArray(o,r),!1==checkLekCountandLekNum?(fillEmptyLekArr(),convertWordObjToArrOfArr(wordsFromXlsx)):!0==checkLekCountandLekNum&&redirectToChangeLekNum()}else if("googleSheet"==fileType){var o=Number(r.Sheets.Sheet1.B2.v)+2;setWordsArray(o,r),!1==checkLekCountandLekNum?(fillEmptyLekArr(),convertWordObjToArrOfArr(wordsFromXlsx)):!0==checkLekCountandLekNum&&redirectToChangeLekNum()}}async function setWordsArray(numOfWords,workbook){if("localFile"==fileType)for(var i=2;i<=numOfWords;i++){var obj={Lek:0,Du_word:"",Du_example:"",Ar_word:"",Ar_example:""},leknum=Number(eval(`workbook.Sheets.Sheet1.A${i}.v.slice(3)`)),DuWord="---";void 0!==eval(`workbook.Sheets.Sheet1.B${i}`)&&(DuWord=eval(`workbook.Sheets.Sheet1.B${i}.v`));var DuExample="---";void 0!==eval(`workbook.Sheets.Sheet1.C${i}`)&&(DuExample=eval(`workbook.Sheets.Sheet1.C${i}.v`));var ArWord="---";void 0!==eval(`workbook.Sheets.Sheet1.D${i}`)&&(ArWord=eval(`workbook.Sheets.Sheet1.D${i}.v`));var ArExample="---";if(void 0!==eval(`workbook.Sheets.Sheet1.E${i}`)&&(ArExample=eval(`workbook.Sheets.Sheet1.E${i}.v`)),leknum>lekCount){console.log("yes"),checkLekCountandLekNum=!0;return}obj.Lek=leknum,obj.Du_word=DuWord,obj.Du_example=DuExample,obj.Ar_word=ArWord,obj.Ar_example=ArExample;var lekArrIndex=leknum-1;wordsFromXlsx[lekArrIndex].push(obj)}else if("googleSheet"==fileType)for(var i=3;i<=numOfWords;i++){var obj={Lek:0,Du_word:"",Du_example:"",Ar_word:"",Ar_example:""},leknum=Number(eval(`workbook.Sheets.Sheet1.B${i}.v.slice(3)`)),DuWord="---";void 0!==eval(`workbook.Sheets.Sheet1.C${i}`)&&(DuWord=eval(`workbook.Sheets.Sheet1.C${i}.v`));var DuExample="---";void 0!==eval(`workbook.Sheets.Sheet1.D${i}`)&&(DuExample=eval(`workbook.Sheets.Sheet1.D${i}.v`));var ArWord="---";void 0!==eval(`workbook.Sheets.Sheet1.E${i}`)&&(ArWord=eval(`workbook.Sheets.Sheet1.E${i}.v`));var ArExample="---";if(void 0!==eval(`workbook.Sheets.Sheet1.F${i}`)&&(ArExample=eval(`workbook.Sheets.Sheet1.F${i}.v`)),leknum>lekCount){checkLekCountandLekNum=!0;return}obj.Lek=leknum,obj.Du_word=DuWord,obj.Du_example=DuExample,obj.Ar_word=ArWord,obj.Ar_example=ArExample;var lekArrIndex=leknum-1;wordsFromXlsx[lekArrIndex].push(obj)}}function fillEmptyLekArr(){for(var e=0;e<wordsFromXlsx.length;e++){var r={Lek:0,Du_word:"Empty",Du_example:"Empty",Ar_word:"Empty",Ar_example:"Empty"},o=e+1;0==wordsFromXlsx[e].length&&(r.Lek=o,wordsFromXlsx[e].push(r))}}function convertWordObjToArrOfArr(e){for(var r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++){var t=[];lekname="lek"+e[r][o].Lek,DuWord=e[r][o].Du_word,DuExample=e[r][o].Du_example,ArWord=e[r][o].Ar_word,ArExample=e[r][o].Ar_example,(""!=DuWord||""!=ArWord)&&(t.push(lekname),t.push(DuWord),t.push(DuExample),t.push(ArWord),t.push(ArExample),WordsToWrite.push(t))}}function redirectToChangeLekNum(){var e=document.getElementById("redirect1"),r=document.getElementById("redirectContainer"),o=document.getElementById("downloadPageContainer");e.classList.remove("d-none"),r.classList.remove("d-none"),o.classList.add("d-none"),setTimeout(()=>{window.location.href="setFile.html"},8e3)}function defineFileStatus(){var e=document.getElementById("redirect"),r=document.getElementById("redirectContainer"),o=document.getElementById("downloadPageContainer");null==localStorage.getItem("fileSource")&&null==localStorage.getItem("lekCount")&&null==localStorage.getItem("sourceType")?(e.classList.remove("d-none"),r.classList.remove("d-none"),o.classList.add("d-none"),setTimeout(()=>{window.location.href="setFile.html"},5e3)):(fileName=localStorage.getItem("fileSource"),lekCount=Number(localStorage.getItem("lekCount")),fileType=localStorage.getItem("sourceType"))}function writeMyXlsxFile(e){var r=XLSX.utils.book_new();r.Props={Title:"Deutsch W\xf6rter",Subject:"Deutsch Kurs",Author:"Moataz Nasser",CreatedDate:new Date(2020,11,11)},r.SheetNames.push("Sheet1");var o=[`${e.length}`];e.unshift(o);var t=XLSX.utils.aoa_to_sheet(e);r.Sheets.Sheet1=t;var l=XLSX.write(r,{bookType:"xlsx",type:"binary"});function s(e){for(var r=new ArrayBuffer(e.length),o=new Uint8Array(r),t=0;t<e.length;t++)o[t]=255&e.charCodeAt(t);return r}$("#button-a").click(function(){saveAs(new Blob([s(l)],{type:"application/octet-stream"}),"Deutsch_Wort.xlsx")})}async function startFromHere(){await defineFileStatus(),await setArrays(lekCount),await readMyXlsxFile(fileName),words=await wordsFromXlsx,writeMyXlsxFile(WordsToWrite)}startFromHere();